name: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ EPG

on:
  workflow_dispatch: # –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫
  schedule:
    - cron: '0 */6 * * *' # –ö–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤

jobs:
  update:
    runs-on: ubuntu-latest
    steps:
      - name: üõ†Ô∏è Checkout
        uses: actions/checkout@v4

      - name: üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'

      - name: üîΩ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
        run: npm install axios xml2js

      - name: üì• –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –ø–∞—Ä—Å–∏–Ω–≥ EPG
        run: node update-epg.js

      - name: üì§ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∫–æ–º–º–∏—Ç
        run: |
          git config user.name "EPG Bot"
          git config user.email "epg@localhost"
          git add data/
          git diff --cached --exit-code || git commit -m "üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ $(date)"
          git push origin main
